local w
local b
local c
local created = false
dw =

function init()
	-- create Gadgets
	w = _window( 150 , 60 , 20 , 20 , "Neues Fenster" )
	b = _button( 30 , 20 , 20 , 20 , "Click!" )
	c = _checkbox( 10 , 11 )

	-- construct the Tree
	w:addChild( b )
	w:addChild( c )
	registerToWindows( w )

	-- register Handler-Functions
	w:registerEventHandler( "dragging" , dragHandler )
	w:registerEventHandler( "dragStart" , dragHandler )
	b:registerEventHandler( "mouseClick" , clickHandler )

	-- customize them
	b:setAutoSelect()

end

-- dragHandler to display Dragging-Params in window-title
function dragHandler( e )
	local dest = e:getArgs():getDestination():toDerived()
	if e:getType() == "dragging" then
		if dest:handleEventDefault( e ) == "not_handled" then
			dest:setTitle( string.format( "%i - Delta: %i" , e:getArgs():getPosX() , e:getArgs():getDeltaX() ) )
		end
	elseif e:getType() == "dragStart" then
		w:handleEventDefault( e )
	end
	return "handled"
end

-- clickHandler to handle Click Events on Button1
function clickHandler()
	if created then
		b2:delete()
	end
	b2 = _button( math.random( 40 ) , 45 , "Ok!" )
	--print( b2 == b )
	w:addChild( b2 )
	b2:registerEventHandler( "mouseClick" , setValue )
	created = true
	return "handled"
end

function setValue()
	c:setIntValue( math.random( 0 , 2 ) )
	return "handled"
end

--local st,err = pcall(init)
--print(err)
